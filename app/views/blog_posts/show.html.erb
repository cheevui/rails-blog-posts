<div class="mx-4">
    <% if @blog_post.featured_image.attached? %>
    <div class="flex justify-center mb-4">
        <%= image_tag @blog_post.featured_image, style: "max-width: 500px; height: auto;" %>
    </div>
    <% end %>

    <h1 class="text-4xl font-bold"><%= @blog_post.title %></h1>

    <div class="my-2">
        <%= @blog_post.content %>
    </div>

    <div class="mb-2 text-sm text-gray-600">
    </div>

    <div class="w-full flex">
        <p class="text-sm text-gray-600 self-center">Created at: <%= @blog_post.created_at.strftime("%Y-%m-%d %H:%M") %></p>
        <% if user_signed_in? && @blog_post.user == current_user %>
        <%= link_to "Edit", edit_blog_post_path(@blog_post), class: "ms-auto hover:text-blue-500 hover:underline mr-1" %> |
        <%= link_to "Back", blog_posts_path, class: "hover:text-blue-500 hover:underline ml-1" %>
        <% else %>
        <%= link_to "Back", blog_posts_path, class: "ms-auto hover:text-blue-500 hover:underline" %>
        <% end %>
    </div>

    <hr class="my-3">

    <div class="flex flex-col max-w-3xl mx-auto mt-1 p-6 bg-white shadow rounded-lg">
        <div class="flex justify-center">
            <h3 class="text-4xl font-bold mb-3">Comments</h3>
        </div>
        <% @blog_post.comments.each do |comment| %>
        <div style=" margin-bottom: 20px;">
            <strong><%= comment.user.user_name %>:</strong> <br>

            <div class="my-1">
                <%= comment.content %>
            </div>

            <div class="flex">
                <p class=" text-sm text-gray-600 mr-auto self-center"><%= comment.created_at.strftime("%Y-%m-%d %H:%M") %></p>

                <% if comment.user == current_user %>
                <%= button_to "Delete", 
                blog_post_comment_path(@blog_post, comment.id),
                method: :delete, 
                data: { confirm: "Are you sure you want to delete this comment?" }, class: "bg-red-500 p-1 rounded hover:bg-red-600 cursor-pointer" %>
                <% end %>
            </div>
        </div>
        <% end %>

        <h4>Add a Comment:</h4>
        <%= form_with(model: [@blog_post, @blog_post.comments.build]) do |form| %>
        <div>
            <%= form.rich_text_area :content, rows: 3, placeholder: "Write your comment..." %>
        </div>
        <div class="flex justify-end mt-2">
            <%= form.submit "Post Comment", class: "bg-blue-500 rounded p-1 cursor-pointer hover:bg-blue-600" %>
        </div>
        <% end %>
    </div>
</div>